
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Appendix: Useful formulas</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>

        <script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
        <script src="http://sagecell.sagemath.org/static/embedded_sagecell.js"></script>

        <script>sagecell.makeSagecell({inputLocation: ".sage"});</script>

        <style type="text/css">
                .sagecell .CodeMirror-scroll {
                        overflow-y: hidden;
                        overflow-x: auto;
                }
                .sagecell .CodeMirror {
                        height: auto;
                }
        </style>

    
    <link rel="top" title="Finite Difference Computing with Partial Differential Equations" href="index.html" />
    <link rel="next" title="Appendix: Truncation error analysis" href="._book021.html" />
    <link rel="prev" title="Exercises" href="._book019.html" />
 
  
       <style type="text/css">
         div.admonition {
           background-color: whiteSmoke;
           border: 1px solid #bababa;
         }
       </style>
      </head>
    
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="._book021.html" title="Appendix: Truncation error analysis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="._book019.html" title="Exercises"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Finite Difference Computing with Partial Differential Equations</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="appendix-useful-formulas">
<span id="ch-formulas"></span><h1>Appendix: Useful formulas<a class="headerlink" href="#appendix-useful-formulas" title="Permalink to this headline">¶</a></h1>
<div class="section" id="finite-difference-operator-notation">
<span id="sec-form-fdop"></span><h2>Finite difference operator notation<a class="headerlink" href="#finite-difference-operator-notation" title="Permalink to this headline">¶</a></h2>
<div class="math" id="eq-dop-fd1-center">
\[\tag{603}
u'(t_n) \approx
    \lbrack D_tu\rbrack^n = \frac{u^{n+\frac{1}{2}} - u^{n-\frac{1}{2}}}{\Delta t}\]</div>
<div class="math" id="eq-dop-fd1-center2">
\[\tag{604}
u'(t_n) \approx
    \lbrack D_{2t}u\rbrack^n = \frac{u^{n+1} - u^{n-1}}{2\Delta t}\]</div>
<div class="math" id="eq-dop-fd1-bw">
\[\tag{605}
u'(t_n) =
    \lbrack D_t^-u\rbrack^n = \frac{u^{n} - u^{n-1}}{\Delta t}\]</div>
<div class="math" id="eq-dop-fd1-fw">
\[\tag{606}
u'(t_n) \approx
    \lbrack D_t^+u\rbrack^n = \frac{u^{n+1} - u^{n}}{\Delta t}\]</div>
<div class="math" id="eq-dop-fd1-theta">
\[\tag{607}
u'(t_{n+\theta}) =
    \lbrack \bar D_tu\rbrack^{n+\theta} = \frac{u^{n+1} - u^{n}}{\Delta t}\]</div>
<div class="math" id="eq-dop-fd1-bw2">
\[\tag{608}
u'(t_n) \approx
    \lbrack D_t^{2-}u\rbrack^n = \frac{3u^{n} - 4u^{n-1} + u^{n-2}}{2\Delta t}\]</div>
<div class="math" id="eq-dop-fd2-center">
\[\tag{609}
u''(t_n) \approx
    \lbrack D_tD_t u\rbrack^n = \frac{u^{n+1} - 2u^{n} + u^{n-1}}{\Delta t^2}\]</div>
<div class="math" id="eq-dop-avg-arith">
\[\tag{610}
u(t_{n+\frac{1}{2}}) \approx \lbrack \overline{u}^{t}\rbrack^{n+\frac{1}{2}}
    = \frac{1}{2}(u^{n+1} + u^n)\]</div>
<div class="math" id="eq-dop-avg-geom">
\[\tag{611}
u(t_{n+\frac{1}{2}})^2 \approx \lbrack \overline{u^2}^{t,g}\rbrack^{n+\frac{1}{2}}
    = u^{n+1}u^n\]</div>
<div class="math" id="eq-dop-avg-harm">
\[\tag{612}
u(t_{n+\frac{1}{2}}) \approx \lbrack \overline{u}^{t,h}\rbrack^{n+\frac{1}{2}}
    = \frac{2}{\frac{1}{u^{n+1}} + \frac{1}{u^n}}\]</div>
<div class="math" id="eq-dop-avg-theta">
\[\tag{613}
u(t_{n+\theta}) \approx \lbrack \overline{u}^{t,\theta}\rbrack^{n+\theta}
    = \theta u^{n+1} + (1-\theta)u^n ,\]</div>
<div class="math" id="eq-auto250">
\[\tag{614}
\qquad t_{n+\theta}=\theta t_{n+1} + (1-\theta)t_{n-1}\]</div>
<p>Some may wonder why <span class="math">\(\theta\)</span> is absent on the right-hand side
of <a class="reference internal" href="#eq-dop-fd1-theta"><span class="std std-ref">(607)</span></a>. The fraction is an approximation to the
derivative at the point <span class="math">\(t_{n+\theta}=\theta t_{n+1} + (1-theta) t_{n}\)</span>.</p>
</div>
<div class="section" id="truncation-errors-of-finite-difference-approximations">
<span id="sec-form-truncerr"></span><h2>Truncation errors of finite difference approximations<a class="headerlink" href="#truncation-errors-of-finite-difference-approximations" title="Permalink to this headline">¶</a></h2>
<div class="math">
\[{u_{\small\mbox{e}}}'(t_n) =
[D_t{u_{\small\mbox{e}}}]^n + R^n = \frac{{u_{\small\mbox{e}}}^{n+\frac{1}{2}} - {u_{\small\mbox{e}}}^{n-\frac{1}{2}}}{\Delta t} +R^n\nonumber,\]</div>
<div class="math" id="eq-form-trunc-fd1-center">
\[\tag{615}
R^n = -\frac{1}{24}{u_{\small\mbox{e}}}'''(t_n)\Delta t^2 + {\cal O}(\Delta t^4)\]</div>
<div class="math">
\[{u_{\small\mbox{e}}}'(t_n) =
[D_{2t}{u_{\small\mbox{e}}}]^n +R^n = \frac{{u_{\small\mbox{e}}}^{n+1} - {u_{\small\mbox{e}}}^{n-1}}{2\Delta t} +
R^n\nonumber,\]</div>
<div class="math" id="eq-form-trunc-fd1-center2">
\[\tag{616}
R^n = -\frac{1}{6}{u_{\small\mbox{e}}}'''(t_n)\Delta t^2 + {\cal O}(\Delta t^4)\]</div>
<div class="math">
\[{u_{\small\mbox{e}}}'(t_n) =
[D_t^-{u_{\small\mbox{e}}}]^n +R^n = \frac{{u_{\small\mbox{e}}}^{n} - {u_{\small\mbox{e}}}^{n-1}}{\Delta t}
+R^n\nonumber,\]</div>
<div class="math" id="eq-form-trunc-fd1-bw">
\[\tag{617}
R^n = -\frac{1}{2}{u_{\small\mbox{e}}}''(t_n)\Delta t + {\cal O}(\Delta t^2)\]</div>
<div class="math">
\[{u_{\small\mbox{e}}}'(t_n) =
[D_t^+{u_{\small\mbox{e}}}]^n +R^n = \frac{{u_{\small\mbox{e}}}^{n+1} - {u_{\small\mbox{e}}}^{n}}{\Delta t}
+R^n\nonumber,\]</div>
<div class="math" id="eq-form-trunc-fd1-fw">
\[\tag{618}
R^n = \frac{1}{2}{u_{\small\mbox{e}}}''(t_n)\Delta t + {\cal O}(\Delta t^2)\]</div>
<div class="math">
\[{u_{\small\mbox{e}}}'(t_{n+\theta}) =
[\bar D_t{u_{\small\mbox{e}}}]^{n+\theta} +R^{n+\theta} = \frac{{u_{\small\mbox{e}}}^{n+1} - {u_{\small\mbox{e}}}^{n}}{\Delta t}
+R^{n+\theta}\nonumber,\]</div>
<div class="math">
\[R^{n+\theta} = -\frac{1}{2}(1-2\theta){u_{\small\mbox{e}}}''(t_{n+\theta})\Delta t +
\frac{1}{6}((1 - \theta)^3 - \theta^3){u_{\small\mbox{e}}}'''(t_{n+\theta})\Delta t^2 +
\nonumber\]</div>
<div class="math" id="eq-form-trunc-fd1-theta">
\[\tag{619}
\quad {\cal O}(\Delta t^3)\]</div>
<div class="math">
\[{u_{\small\mbox{e}}}'(t_n) =
[D_t^{2-}{u_{\small\mbox{e}}}]^n +R^n = \frac{3{u_{\small\mbox{e}}}^{n} - 4{u_{\small\mbox{e}}}^{n-1} + {u_{\small\mbox{e}}}^{n-2}}{2\Delta t}
+R^n\nonumber,\]</div>
<div class="math" id="eq-form-trunc-fd1-bw2">
\[\tag{620}
R^n = \frac{1}{3}{u_{\small\mbox{e}}}'''(t_n)\Delta t^2 + {\cal O}(\Delta t^3)\]</div>
<div class="math">
\[{u_{\small\mbox{e}}}''(t_n) =
[D_tD_t {u_{\small\mbox{e}}}]^n +R^n = \frac{{u_{\small\mbox{e}}}^{n+1} - 2{u_{\small\mbox{e}}}^{n} + {u_{\small\mbox{e}}}^{n-1}}{\Delta t^2}
+R^n\nonumber,\]</div>
<div class="math" id="eq-form-trunc-fd2-center">
\[\tag{621}
R^n = -\frac{1}{12}{u_{\small\mbox{e}}}''''(t_n)\Delta t^2 + {\cal O}(\Delta t^4)\]</div>
<div class="math">
\[{u_{\small\mbox{e}}}(t_{n+\theta}) = [\overline{{u_{\small\mbox{e}}}}^{t,\theta}]^{n+\theta} +R^{n+\theta}
= \theta {u_{\small\mbox{e}}}^{n+1} + (1-\theta){u_{\small\mbox{e}}}^n +R^{n+\theta},\nonumber\]</div>
<div class="math" id="eq-form-trunc-avg-theta">
\[\tag{622}
R^{n+\theta} = -\frac{1}{2}{u_{\small\mbox{e}}}''(t_{n+\theta})\Delta t^2\theta (1-\theta) +
    {\cal O}(\Delta t^3)
    {\thinspace .}\]</div>
</div>
<div class="section" id="finite-differences-of-exponential-functions">
<span id="sec-form-fdexp"></span><h2>Finite differences of exponential functions<a class="headerlink" href="#finite-differences-of-exponential-functions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="complex-exponentials">
<h3>Complex exponentials<a class="headerlink" href="#complex-exponentials" title="Permalink to this headline">¶</a></h3>
<p>Let <span class="math">\(u^n = \exp{(i\omega n\Delta t)} = e^{i\omega t_n}\)</span>.</p>
<div class="math" id="eq-form-exp-fd2-center">
\[\tag{623}
[D_tD_t u]^n = u^n \frac{2}{\Delta t}(\cos \omega\Delta t - 1) =
    -\frac{4}{\Delta t}\sin^2\left(\frac{\omega\Delta t}{2}\right),\]</div>
<div class="math" id="eq-form-exp-fd1-fw">
\[\tag{624}
[D_t^+ u]^n = u^n\frac{1}{\Delta t}(\exp{(i\omega\Delta t)} - 1),\]</div>
<div class="math" id="eq-form-exp-fd1-bw">
\[\tag{625}
[D_t^- u]^n = u^n\frac{1}{\Delta t}(1 - \exp{(-i\omega\Delta t)}),\]</div>
<div class="math" id="eq-form-exp-fd1-center">
\[\tag{626}
[D_t u]^n = u^n\frac{2}{\Delta t}i\sin{\left(\frac{\omega\Delta t}{2}\right)},\]</div>
<div class="math" id="eq-form-exp-fd1c-center">
\[ \begin{align}\begin{aligned}\tag{627}
[D_{2t} u]^n = u^n\frac{1}{\Delta t}i\sin{(\omega\Delta t)}\\    {\thinspace .}\end{aligned}\end{align} \]</div>
</div>
<div class="section" id="real-exponentials">
<h3>Real exponentials<a class="headerlink" href="#real-exponentials" title="Permalink to this headline">¶</a></h3>
<p>Let <span class="math">\(u^n = \exp{(\omega n\Delta t)} = e^{\omega t_n}\)</span>.</p>
<div class="math" id="eq-form-rexp-fd2-center">
\[\tag{628}
[D_tD_t u]^n = u^n \frac{2}{\Delta t}(\cos \omega\Delta t - 1) =
    -\frac{4}{\Delta t}\sin^2\left(\frac{\omega\Delta t}{2}\right),\]</div>
<div class="math" id="eq-form-rexp-fd1-fw">
\[\tag{629}
[D_t^+ u]^n = u^n\frac{1}{\Delta t}(\exp{(i\omega\Delta t)} - 1),\]</div>
<div class="math" id="eq-form-rexp-fd1-bw">
\[\tag{630}
[D_t^- u]^n = u^n\frac{1}{\Delta t}(1 - \exp{(-i\omega\Delta t)}),\]</div>
<div class="math" id="eq-form-rexp-fd1-center">
\[\tag{631}
[D_t u]^n = u^n\frac{2}{\Delta t}i\sin{\left(\frac{\omega\Delta t}{2}\right)},\]</div>
<div class="math" id="eq-form-rexp-fd1c-center">
\[ \begin{align}\begin{aligned}\tag{632}
[D_{2t} u]^n = u^n\frac{1}{\Delta t}i\sin{(\omega\Delta t)}\\    {\thinspace .}\end{aligned}\end{align} \]</div>
</div>
</div>
<div class="section" id="finite-differences-of">
<span id="sec-form-fdtn"></span><h2>Finite differences of <span class="math">\(t^n\)</span><a class="headerlink" href="#finite-differences-of" title="Permalink to this headline">¶</a></h2>
<p>The following results are useful when checking if a polynomial term in a
solution fulfills the discrete equation for the numerical method.</p>
<div class="math" id="eq-form-dop-tn-fw">
\[\tag{633}
\lbrack D_t^+ t\rbrack^n = 1,\]</div>
<div class="math" id="eq-form-dop-tn-bw">
\[\tag{634}
\lbrack D_t^- t\rbrack^n = 1,\]</div>
<div class="math" id="eq-form-dop-tn-cn">
\[\tag{635}
\lbrack D_t t\rbrack^n = 1,\]</div>
<div class="math" id="eq-form-dop-tn-2cn">
\[\tag{636}
\lbrack D_{2t} t\rbrack^n = 1,\]</div>
<div class="math" id="eq-form-dop2-tn-cn">
\[ \begin{align}\begin{aligned}\tag{637}
\lbrack D_{t}D_t t\rbrack^n = 0\\    {\thinspace .}\end{aligned}\end{align} \]</div>
<p>The next formulas concern the action of difference operators on a <span class="math">\(t^2\)</span> term.</p>
<div class="math" id="eq-form-dop-tn2-fw">
\[\tag{638}
\lbrack D_t^+ t^2\rbrack^n = (2n+1)\Delta t,\]</div>
<div class="math" id="eq-form-dop-tn2-bw">
\[\tag{639}
\lbrack D_t^- t^2\rbrack^n = (2n-1)\Delta t,\]</div>
<div class="math" id="eq-form-dop-tn2-cn">
\[\tag{640}
\lbrack D_t t^2\rbrack^n = 2n\Delta t,\]</div>
<div class="math" id="eq-form-dop-tn2-2cn">
\[\tag{641}
\lbrack D_{2t} t^2\rbrack^n = 2n\Delta t,\]</div>
<div class="math" id="eq-form-dop2-tn2-cn">
\[\tag{642}
\lbrack D_{t}D_t t^2\rbrack^n = 2,\]</div>
<p>Finally, we present formulas for a <span class="math">\(t^3\)</span> term:</p>
<div class="math" id="eq-form-dop-tn3-fw">
\[\tag{643}
\lbrack D_t^+ t^3\rbrack^n = 3(n\Delta t)^2 + 3n\Delta t^2 + \Delta t^2,\]</div>
<div class="math" id="eq-form-dop-tn3-bw">
\[\tag{644}
\lbrack D_t^- t^3\rbrack^n = 3(n\Delta t)^2 - 3n\Delta t^2 + \Delta t^2,\]</div>
<div class="math" id="eq-form-dop-tn3-cn">
\[\tag{645}
\lbrack D_t t^3\rbrack^n = 3(n\Delta t)^2 + \frac{1}{4}\Delta t^2,\]</div>
<div class="math" id="eq-form-dop-tn3-2cn">
\[\tag{646}
\lbrack D_{2t} t^3\rbrack^n = 3(n\Delta t)^2 + \Delta t^2,\]</div>
<div class="math" id="eq-form-dop2-tn3-cn">
\[\tag{647}
\lbrack D_{t}D_t t^3\rbrack^n = 6n\Delta t,\]</div>
<p>Application of finite difference operators to polynomials and exponential
functions, resulting in the formulas above, can easily be computed by
some <code class="docutils literal"><span class="pre">sympy</span></code> code (from the file <a class="reference external" href="http://tinyurl.com/nu656p2/formulas/lib.py">lib.py</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;t dt n w&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># Finite difference operators</span>

<span class="k">def</span> <span class="nf">D_t_forward</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span><span class="p">)</span> <span class="o">-</span> <span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">))</span><span class="o">/</span><span class="n">dt</span>

<span class="k">def</span> <span class="nf">D_t_backward</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">dt</span><span class="p">))</span><span class="o">/</span><span class="n">dt</span>

<span class="k">def</span> <span class="nf">D_t_centered</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">dt</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">dt</span>

<span class="k">def</span> <span class="nf">D_2t_centered</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span><span class="p">)</span> <span class="o">-</span> <span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">dt</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">D_t_D_t</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">u</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">dt</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dt</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>


<span class="n">op_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">D_t_forward</span><span class="p">,</span> <span class="n">D_t_backward</span><span class="p">,</span>
           <span class="n">D_t_centered</span><span class="p">,</span> <span class="n">D_2t_centered</span><span class="p">,</span> <span class="n">D_t_D_t</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">ft1</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">t</span>

<span class="k">def</span> <span class="nf">ft2</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span>

<span class="k">def</span> <span class="nf">ft3</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">t</span><span class="o">**</span><span class="mi">3</span>

<span class="k">def</span> <span class="nf">f_expiwt</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">f_expwt</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="n">w</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="n">func_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ft1</span><span class="p">,</span> <span class="n">ft2</span><span class="p">,</span> <span class="n">ft3</span><span class="p">,</span> <span class="n">f_expiwt</span><span class="p">,</span> <span class="n">f_expwt</span><span class="p">]</span>
</pre></div>
</div>
<p>To see the results, one can now make a simple loop over the different
type of functions and the various operators associated with them:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">func_list</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">op_list</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">func</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">expand</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
        <span class="k">print</span> <span class="n">e</span>
        <span class="k">if</span> <span class="n">func</span> <span class="ow">in</span> <span class="p">[</span><span class="n">f_expiwt</span><span class="p">,</span> <span class="n">f_expwt</span><span class="p">]:</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">e</span><span class="o">/</span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">n</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span>
        <span class="k">print</span> <span class="n">expand</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">print</span> <span class="n">factor</span><span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="n">expand</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <center>
            <p class="logo"><a href="http://cbc.simula.no/" title="Go to Center for Biomedical Computing">
              <img class="logo" src="_static/cbc_logo.png" alt="Logo"/>
            </a></p>
            </center>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Appendix: Useful formulas</a><ul>
<li><a class="reference internal" href="#finite-difference-operator-notation">Finite difference operator notation</a></li>
<li><a class="reference internal" href="#truncation-errors-of-finite-difference-approximations">Truncation errors of finite difference approximations</a></li>
<li><a class="reference internal" href="#finite-differences-of-exponential-functions">Finite differences of exponential functions</a><ul>
<li><a class="reference internal" href="#complex-exponentials">Complex exponentials</a></li>
<li><a class="reference internal" href="#real-exponentials">Real exponentials</a></li>
</ul>
</li>
<li><a class="reference internal" href="#finite-differences-of">Finite differences of <span class="math">\(t^n\)</span></a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="._book019.html"
                        title="previous chapter">Exercises</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="._book021.html"
                        title="next chapter">Appendix: Truncation error analysis</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/._book020.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="._book021.html" title="Appendix: Truncation error analysis"
             >next</a> |</li>
        <li class="right" >
          <a href="._book019.html" title="Exercises"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Finite Difference Computing with Partial Differential Equations</a> &raquo;</li> 
      </ul>
    </div>
<div class="wrapper">
  <div class="footer">
    <a href="http://cbc.simula.no"><img src="_static/cbc_banner.png" width="100%"><a>
    <br />
    <br />
      &copy;2016, Hans Petter Langtangen, Svein Linge. Released under CC Attribution 4.0 license.
  </div>
</div>

  </body>
</html>